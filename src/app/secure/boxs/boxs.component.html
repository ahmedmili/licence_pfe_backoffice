<br>
<br>
<br>
<br>
<div class="row">
  <div class="col-md-10 mb-4">
    <input type="text" class="form-control" placeholder="Search by Id, Partner Id or title" [(ngModel)]="search" (keyup.enter)="SearchBox()">
  </div>
  <div class="col-md-2 mb-4">
    <div class="input-group-append">
      <select class="form-select select-width" id="status-select" (change)="getStatusInputValueBox($any($event).target.value)">
        <option value="">Select</option>
        <option value="PENDING">Pending</option>
        <option value="ACCEPTED">Accepted</option>
        <option value="REJECTED">Rejected</option>
        <option value="FINISHED">Finished</option>
        <option value="EXPIRED">Expired</option>
      </select>
    </div>
  </div>
</div>


<div class="pt-3 pb-2 mb-3 border-bottom">
  <a routerLink="/boxs/create" class="btn btn-sm btn-outline-secondary">Add</a>
</div>
<div *ngIf=" loaded && dataSource.data.length == 0" class="alert alert-warning">
  No Data Found
</div>
<div class="spinner-container" *ngIf="!loaded">
  <div class="spinner">
    <mat-spinner></mat-spinner>
  </div>
</div>

<table mat-table *ngIf="dataSource.data.length >0 && loaded" [dataSource]="dataSource" class="table table-striped table-sm mat-elevation-z8 custom-table">

  <ng-container matColumnDef="ID">
    <th mat-header-cell *matHeaderCellDef class="col-md-0.5 column-cell text-center custom-th custom-header-row">#</th>
    <td mat-cell *matCellDef="let box" class="col-md-0.5 column-cell text-center custom-th custom-header-row"> {{box.id}} </td>
  </ng-container>

  <ng-container matColumnDef="title">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Title</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.title}} </td>
  </ng-container>

  <ng-container matColumnDef="description" >
    <th mat-header-cell *matHeaderCellDef class="col-md-2 column-cell text-center custom-th custom-header-row">Description</th>
    <td mat-cell *matCellDef="let box" [ngClass]="'discription'" class="col-md-2 column-cell text-center custom-th custom-header-row"> {{box.description}} </td>
  </ng-container>

  <ng-container matColumnDef="oldprice">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Old Price</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.oldprice}} </td>
  </ng-container>

  <ng-container matColumnDef="newprice">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">New Price</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.newprice}} </td>
  </ng-container>

  <ng-container matColumnDef="startdate">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Start Availability</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.startdate}} </td>
  </ng-container>

  <ng-container matColumnDef="enddate">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">End Of Availability</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.enddate}} </td>
  </ng-container>

  <ng-container matColumnDef="quantity">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Quantity</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.quantity}} </td>
  </ng-container>

  <ng-container matColumnDef="remaining_quantity">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Remaining Quantity</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.remaining_quantity}} </td>
  </ng-container>

  <ng-container matColumnDef="image">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Image</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row">
      <img [src]="box.image? imageDirectoryPath+box.image : 'assets/images/noImg'" height="50" />
    </td>
  </ng-container>

  <ng-container matColumnDef="category">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Category</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row"> {{box.category}} </td>
  </ng-container>

  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Status</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row">
      <select [(ngModel)]="box.status" class="form-select select-width" (change)="toggleStatus(box)">
        <option value="PENDING">PENDING</option>
        <option value="ACCEPTED">ACCEPTED</option>
        <option value="REJECTED">REJECTED</option>
        <option value="FINISHED">FINISHED</option>
        <option value="EXPIRED">EXPIRED</option>
      </select>
    </td>
  </ng-container>



  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef class="col-md-1 column-cell text-center custom-th custom-header-row">Actions</th>
    <td mat-cell *matCellDef="let box" class="col-md-1 column-cell text-center custom-th custom-header-row">
   
      <button mat-icon-button [routerLink]="['/boxs',box.id,'edit']">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-icon-button (click)="delete(box .id)">
        <mat-icon>delete</mat-icon>
      </button>
    </td>
  </ng-container>

  <ng-container matColumnDef="show details">
    <th mat-header-cell *matHeaderCellDef class="col-md-0.5 column-cell text-center custom-th custom-header-row">Show Details</th>
    <td mat-cell *matCellDef="let box" class="col-md-0.5 column-cell text-center custom-th custom-header-row">
      
    <button [routerLink]="['/boxs',box.id,'details']" mat-icon-button >
      <mat-icon>find_in_page</mat-icon>
    </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columns"></tr>
  <tr mat-row *matRowDef="let row; columns:columns;"></tr>

</table>

<mat-paginator [pageSizeOptions]="[5, 10, 20]"
showFirstLastButtons 
aria-label="Select page of periodic elements">
</mat-paginator>
